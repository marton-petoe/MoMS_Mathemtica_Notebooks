(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34048,        759]
NotebookOptionsPosition[     32760,        735]
NotebookOutlinePosition[     33133,        751]
CellTagsIndexPosition[     33090,        748]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox[" [ \
==============================================================================\
================= ] \n [ Author: M\[AAcute]rton Pet\[ODoubleDot]              \
                                                               ] \n [ Date: \
05.07.2023                                                                    \
            ] \n [ Affiliation: Otto von Guericke University Magdeburg, \
Germany                                    ] \n [ \
------------------------------------------------------------------------------\
----------------- ] \n [ This Mathematica notebook is a supplementary file \
for the examples provided in the article      ] \[LineSeparator] [            \
                                                                              \
       ] \[LineSeparator] [ CODE VERIFICATION OF IMMERSED BOUNDARY TECHNIQUES \
USING THE METHOD OF MANUFACTURED SOLUTIONS    ] \n [ Authors: M. Pet\
\[ODoubleDot], M. Gorji, F. Duvigneau, A. D\[UDoubleDot]ster, D. Juhre, S. \
Eisentr\[ADoubleDot]ger                   ] \n [ Journal: Computational \
Mechanics                                                                ] \n \
[                                                                             \
                    ] \n [ \
------------------------------------------------------------------------------\
----------------- ] \n [ Note 1: When using the methods or results provided \
in the paper and supplementary material,     ] \n [ please cite our work \
accordingly.                                                               ] \
\n [ -------------------------------------------------------------------------\
---------------------- ] \n [ Note 2: The correct evaluation of this script \
requires the loading of the functions stored in   ] \n [ the Mathematica \
notebook \[OpenCurlyDoubleQuote]Utility_functions.nb\[CloseCurlyDoubleQuote]. \
                                               ] \n [ \
==============================================================================\
================= ] ",
 FontFamily->"Courier New",
 FontWeight->"Bold",
 FontColor->RGBColor[0., 0.3411764705882353, 0.5098039215686274],
 Background->RGBColor[
  0.9176470588235294, 0.9176470588235294, 0.9176470588235294]]], "Text",
 CellChangeTimes->{{3.891080212757384*^9, 3.891080215286878*^9}, 
   3.891080263801732*^9, {3.8910804333781233`*^9, 3.8910804363617783`*^9}, {
   3.8975510929546046`*^9, 3.897551110690736*^9}, {3.897632988370968*^9, 
   3.8976329934936304`*^9}},ExpressionUUID->"4ab4f0f1-5349-4daa-8543-\
53b592c4ec8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"DEFINE", " ", "GEOMETRY"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", " ", "=", " ", "4"}], ";", " ", 
    RowBox[{"xC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", " ", 
    RowBox[{"R", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OmegaCube", " ", "=", " ", 
     RowBox[{"ImplicitRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{"x", "\[LessEqual]", "L"}], "&&", 
        RowBox[{"y", "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{"y", "\[LessEqual]", "L"}], "&&", 
        RowBox[{"z", "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{"z", "\[LessEqual]", "L"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OmegaHole", " ", "=", " ", 
     RowBox[{"ImplicitRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", 
             RowBox[{"xC", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", 
             RowBox[{"xC", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"z", "-", 
             RowBox[{"xC", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "^", "2"}]}], 
         "\[LessEqual]", 
         RowBox[{"R", "^", "2"}]}], " ", "&&", 
        RowBox[{"x", "\[GreaterEqual]", "0"}], "&&", " ", 
        RowBox[{"x", "\[LessEqual]", "L"}], "&&", 
        RowBox[{"y", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"y", "\[LessEqual]", "L"}], "&&", 
        RowBox[{"z", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"z", "\[LessEqual]", "L"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OmegaPhys", " ", "=", 
     RowBox[{"RegionDifference", "[", 
      RowBox[{"OmegaCube", ",", "OmegaHole"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"RegionPlot3D", "[", "OmegaPhys", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8721438303616867`*^9, 3.8721439312124453`*^9}, {
  3.874911744889371*^9, 3.8749119272841043`*^9}, {3.890380377231769*^9, 
  3.890380523632745*^9}, {3.890380562181964*^9, 3.890380625966154*^9}, {
  3.8904762335451303`*^9, 3.890476303467319*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"a73fe76b-7303-41d6-a1a5-fcac2502d3ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"DEFINE", " ", "DISPLACEMENT", " ", "FIELD"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"In", " ", "the", " ", "current", " ", "example"}], ",", " ", 
    RowBox[{
    "the", " ", "manufactured", " ", "displacement", " ", "field", " ", "is", 
     " ", "defined", " ", "in", " ", "spherical"}]}], "        ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"coordinates", ".", " ", "Furthermore"}], ",", " ", 
    RowBox[{
    "the", " ", "displacement", " ", "field", " ", "is", " ", "assumed", " ", 
     "to", " ", "be", " ", "radial"}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"only", " ", "its"}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"radial", " ", "is", " ", "component", " ", "is", " ", "non"}], 
     "-", 
     RowBox[{
      RowBox[{"zero", ".", " ", "The"}], " ", "parameter", " ", "\"\<c\>\"", 
      " ", "is", " ", "used", " ", "as", " ", "a", " ", "symbolic", " ", 
      "variable", " ", "here"}]}], ","}], "    ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"and", " ", "it", " ", "will", " ", "be", " ", "defined", " ", 
    RowBox[{"later", ".", " ", "The"}], " ", "equation", " ", "below", " ", 
    "corresponds", " ", "to", " ", "the", " ", "3", "D", " ", "version", " ", 
    "of", " ", 
    RowBox[{"Eq", ".", " ", 
     RowBox[{"(", "28", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "the", " ", 
    RowBox[{"paper", "."}]}], 
   "                                                                          \
    ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"u", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"c", "*", "r"}], "]"}]}], ",", "0", ",", "0"}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{
  3.8903817991588683`*^9, 3.8903818481120872`*^9, {3.890382239469956*^9, 
   3.890382287570819*^9}, {3.891080839674834*^9, 3.891080850390298*^9}, {
   3.891080902863285*^9, 3.8910809396337724`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"48e62b2f-1b7d-4402-8dd1-4c422df3117c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"COMPUTE", " ", "STRAIN"}], ";", " ", 
    RowBox[{"STRESS", " ", "AND", " ", "BODY", " ", "FORCE"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "strain", " ", "tensor", " ", "in", " ", "spherical", " ", 
    "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"epsilon", " ", "=", " ", 
     RowBox[{
      RowBox[{"StrainTensorRadialDispField3D", "[", "u", "]"}], "//", 
      "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "stress", " ", "tensor", " ", "in", " ", "spherical", " ",
      "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigma", " ", "=", " ", 
     RowBox[{
      RowBox[{"StressTensorRadialDispField3D", "[", 
       RowBox[{"epsilon", ",", 
        RowBox[{"Enu2lambda", "[", 
         RowBox[{"Emod", ",", "nu"}], "]"}], ",", 
        RowBox[{"Enu2mu", "[", 
         RowBox[{"Emod", ",", "nu"}], "]"}]}], "]"}], "//", 
      "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "body", " ", "forces", " ", "in", " ", "spherical", " ", 
     "coordinates"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"br", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"StressDivRadialDispField3D", "[", "sigma", "]"}]}], "//", 
      "FullSimplify"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.862453197429579*^9, 3.86245339918213*^9}, {
   3.8624534551001663`*^9, 3.8624535946403985`*^9}, {3.8624536246641455`*^9, 
   3.8624536456516933`*^9}, {3.8624537028471394`*^9, 
   3.8624537482132287`*^9}, {3.862453808600644*^9, 3.8624539490765533`*^9}, {
   3.8624542475890427`*^9, 3.8624542520880165`*^9}, 3.8624542984994526`*^9, {
   3.8624543347987165`*^9, 3.8624543436083455`*^9}, {3.862512931160406*^9, 
   3.8625130760394964`*^9}, {3.862513112780384*^9, 3.8625131344479237`*^9}, {
   3.8625136785483522`*^9, 3.862513685667101*^9}, 3.862513716362374*^9, {
   3.862517317602404*^9, 3.862517338500558*^9}, {3.86254014526632*^9, 
   3.8625403275938244`*^9}, {3.862540375051963*^9, 3.8625404226497717`*^9}, {
   3.8625404957066708`*^9, 3.862540508457292*^9}, {3.862605106296867*^9, 
   3.862605107493254*^9}, {3.862605689087633*^9, 3.8626057059273124`*^9}, {
   3.862605738630061*^9, 3.862605742536232*^9}, {3.862605797999214*^9, 
   3.8626058015897245`*^9}, {3.862616224399046*^9, 3.8626163200094967`*^9}, {
   3.8626163803675632`*^9, 3.8626163917960215`*^9}, {3.862616459920628*^9, 
   3.862616516579118*^9}, {3.862616826099221*^9, 3.862616867036386*^9}, {
   3.8626170284330487`*^9, 3.8626170431482067`*^9}, {3.862619897472831*^9, 
   3.8626199802060814`*^9}, {3.8626200526223497`*^9, 
   3.8626200699918404`*^9}, {3.862634143089902*^9, 3.8626341498368454`*^9}, {
   3.8626342236475897`*^9, 3.8626343284612865`*^9}, {3.862634536921275*^9, 
   3.8626346378867006`*^9}, {3.862808520604746*^9, 3.8628085268587146`*^9}, {
   3.8628096161885266`*^9, 3.8628098516125*^9}, {3.862810025764866*^9, 
   3.8628100492438064`*^9}, {3.8628624548211765`*^9, 3.86286254801847*^9}, {
   3.862862579334817*^9, 3.8628625831485753`*^9}, {3.8628626739702873`*^9, 
   3.8628627112200794`*^9}, {3.8628629083938465`*^9, 3.862862931725785*^9}, {
   3.862863108860002*^9, 3.862863119664485*^9}, {3.8630573437330675`*^9, 
   3.8630573913148727`*^9}, {3.863117623853169*^9, 3.863117639884935*^9}, {
   3.8631180403986254`*^9, 3.8631180409973445`*^9}, {3.8631180829342904`*^9, 
   3.86311808528647*^9}, {3.863118134769801*^9, 3.8631181682385283`*^9}, {
   3.863129941980451*^9, 3.863129989027173*^9}, {3.863130023153535*^9, 
   3.8631300505603924`*^9}, {3.8631300914381113`*^9, 3.863130101357356*^9}, {
   3.863130157626309*^9, 3.8631301682964115`*^9}, 3.8631319674433403`*^9, {
   3.8631326521981506`*^9, 3.8631326640859327`*^9}, {3.8631330322330265`*^9, 
   3.86313305152954*^9}, {3.863133279713406*^9, 3.863133291799385*^9}, {
   3.863133916500808*^9, 3.863133916833454*^9}, {3.8631341671717525`*^9, 
   3.863134167653014*^9}, {3.863135723781291*^9, 3.8631357567456627`*^9}, {
   3.8632072018570023`*^9, 3.863207300828864*^9}, {3.863207348947991*^9, 
   3.863207457212818*^9}, {3.8647023005285983`*^9, 3.864702321327277*^9}, {
   3.864702358552376*^9, 3.864702361086709*^9}, {3.864702419655475*^9, 
   3.864702422046367*^9}, {3.864705553020839*^9, 3.8647055744514112`*^9}, {
   3.8647064562445474`*^9, 3.864706474145708*^9}, {3.872072806640918*^9, 
   3.872072826072974*^9}, {3.872073257480713*^9, 3.8720733064827123`*^9}, {
   3.8721435641525817`*^9, 3.8721436428709908`*^9}, 3.872143786068158*^9, {
   3.872143819838956*^9, 3.8721438228706875`*^9}, {3.872144069747052*^9, 
   3.8721441029092255`*^9}, {3.872218038350812*^9, 3.872218066306532*^9}, {
   3.872218590310201*^9, 3.872218611414099*^9}, {3.8722189620183673`*^9, 
   3.872218986500881*^9}, {3.872219153125653*^9, 3.872219153783549*^9}, {
   3.8722192137003975`*^9, 3.872219213970257*^9}, {3.872219482432624*^9, 
   3.872219503561243*^9}, {3.8722195419291787`*^9, 3.8722195469737597`*^9}, {
   3.8722215358647623`*^9, 3.872221538362148*^9}, {3.872221606725354*^9, 
   3.8722216068978357`*^9}, {3.87222188420676*^9, 3.872221887643524*^9}, {
   3.8722426720599747`*^9, 3.872242672258043*^9}, {3.8728303603484497`*^9, 
   3.8728303608622766`*^9}, {3.872834029015871*^9, 3.8728340372070813`*^9}, 
   3.872834418576486*^9, {3.8728348617465925`*^9, 3.872834864589687*^9}, {
   3.872835701714853*^9, 3.8728357037266474`*^9}, {3.8728358253664064`*^9, 
   3.8728358570376563`*^9}, {3.8728361812708635`*^9, 3.872836181985051*^9}, {
   3.872836313801987*^9, 3.87283637773787*^9}, 3.872836566748764*^9, {
   3.872836723888033*^9, 3.872836750669527*^9}, {3.872845649633783*^9, 
   3.872845666378892*^9}, {3.8728459114984307`*^9, 3.872845983353691*^9}, {
   3.8728471380046005`*^9, 3.8728471463218017`*^9}, {3.8728485791102705`*^9, 
   3.8728485855026536`*^9}, {3.8729207808751574`*^9, 3.872920802251011*^9}, {
   3.8731900704893804`*^9, 3.873190078038612*^9}, {3.873190463260219*^9, 
   3.8731905235076*^9}, {3.874912024048644*^9, 3.8749120775827775`*^9}, {
   3.8749121192925725`*^9, 3.874912164926498*^9}, {3.874912231647015*^9, 
   3.8749122353573947`*^9}, 3.8749122663531675`*^9, {3.874912383864247*^9, 
   3.8749123916022387`*^9}, {3.8749124354273043`*^9, 3.874912436010947*^9}, {
   3.87491266440956*^9, 3.8749126687709484`*^9}, {3.8749132653355217`*^9, 
   3.874913308073621*^9}, {3.8749135975212564`*^9, 3.8749136051523743`*^9}, {
   3.874914172119488*^9, 3.8749141749996147`*^9}, {3.874914292833536*^9, 
   3.8749142935907044`*^9}, {3.8749152277920012`*^9, 
   3.8749152319760666`*^9}, {3.874916322156354*^9, 3.874916323129752*^9}, 
   3.890380641270232*^9, {3.8903811508810043`*^9, 3.8903811833965836`*^9}, {
   3.8903812977306647`*^9, 3.8903813388082867`*^9}, {3.890381503324999*^9, 
   3.8903815207937365`*^9}, {3.890381594857609*^9, 3.890381626388396*^9}, {
   3.8903816578303823`*^9, 3.890381661330142*^9}, 3.890381700864341*^9, {
   3.8903817471022186`*^9, 3.890381759423415*^9}, {3.890381846305075*^9, 
   3.8903819019195423`*^9}, {3.890382046723632*^9, 3.8903820484037037`*^9}, {
   3.890382503830145*^9, 3.890382520674819*^9}, 3.890382551201256*^9, {
   3.890382798394249*^9, 3.8903828023053412`*^9}, 3.89038484783068*^9, {
   3.8903852536384125`*^9, 3.8903852600654755`*^9}, {3.8904764660022388`*^9, 
   3.890476467370185*^9}, {3.8904765039550967`*^9, 3.8904765259516735`*^9}, {
   3.8910809625405855`*^9, 3.891080966307602*^9}, {3.8975511910626717`*^9, 
   3.8975512037731457`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"875a41bc-fbba-40c0-a967-96896b1a9c88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"DISPLAY", " ", "SRTRAIN"}], ",", " ", 
    RowBox[{
    "STRESS", " ", "AND", " ", "BODY", " ", "LOAD", " ", "EQUATIONS"}]}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"epsilon", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"sigma", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"sigma", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"br", "//", "FullSimplify"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Eq", ".", " ", 
      RowBox[{"(", "52", ")"}]}], " ", "in", " ", "the", " ", "paper"}], " ", 
    "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8628674165986934`*^9, 3.862867417468074*^9}, {
   3.862868245453377*^9, 3.8628682484146185`*^9}, {3.8630572956233587`*^9, 
   3.863057306179079*^9}, {3.8631301236661005`*^9, 3.8631301468634243`*^9}, {
   3.863207699136073*^9, 3.8632077637288227`*^9}, {3.8721440335827894`*^9, 
   3.8721440370493755`*^9}, {3.8728341869495397`*^9, 3.872834208146038*^9}, {
   3.8728343645704823`*^9, 3.872834364701787*^9}, 3.8728457090511417`*^9, {
   3.8729169063010035`*^9, 3.8729169129740477`*^9}, {3.874912207958557*^9, 
   3.8749122088250604`*^9}, {3.8749142042765026`*^9, 3.8749142124373693`*^9}, 
   3.890381923619809*^9, 3.8903819538859105`*^9, {3.8903824169263177`*^9, 
   3.890382424835149*^9}, {3.890382583819763*^9, 3.890382596699698*^9}, {
   3.8903827277241173`*^9, 3.8903827334288163`*^9}, {3.890385262257702*^9, 
   3.8903852788919315`*^9}, {3.8910809611710815`*^9, 3.891080986647935*^9}, {
   3.8910810290866957`*^9, 3.891081029695279*^9}, {3.89755129433331*^9, 
   3.8975512944466944`*^9}},ExpressionUUID->"1ef77fd1-bfac-4a45-8153-\
16f6c48779e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"FIND", " ", "VALUE", " ", "FOR", " ", "C"}], ",", " ", 
    RowBox[{
    "SUCH", " ", "THAT", " ", "THE", " ", "RADIAL", " ", "STRESS", " ", "IS", 
     " ", "VANISHING"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stressAtRadius", "=", 
     RowBox[{
      RowBox[{"sigma", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"r", "\[Rule]", "RR"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"stressAtRadius", "\[Equal]", "0"}], ",", "c"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.890381946896309*^9, 3.8903819576484823`*^9}, {
  3.8903827669914775`*^9, 3.8903827680240107`*^9}, {3.8975513486619577`*^9, 
  3.8975513628592644`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"a5b44dd6-0f99-4ee3-9a99-a189a9dda3f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"DEFINE", " ", "C"}], "-", "RULE"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Based", " ", "on", " ", "the", " ", "above", " ", "solution"}], 
    ",", " ", 
    RowBox[{"a", " ", "function", " ", "for", " ", "c", " ", "is", " ", 
     RowBox[{"defined", ".", " ", "See"}], " ", 
     RowBox[{"Eq", ".", " ", 
      RowBox[{"(", "51", ")"}]}], " ", "in", " ", "the", " ", 
     RowBox[{"paper", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cRule", "[", 
     RowBox[{"nu_", ",", "R_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", "R"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "nu"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "nu"}], ")"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Test", ",", " ", 
     RowBox[{
     "whether", " ", "the", " ", "radial", " ", "stress", " ", "component", 
      " ", "is", " ", "indeed", " ", "vanishing", " ", "at", " ", "the", " ", 
      RowBox[{"sphere", "'"}], "s", " ", "boundary"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigma", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "R"}], ",", 
      RowBox[{"Emod", "\[Rule]", "1"}], ",", 
      RowBox[{"nu", "\[Rule]", 
       RowBox[{"3", "/", "10"}]}], ",", 
      RowBox[{"c", "\[Rule]", 
       RowBox[{"cRule", "[", 
        RowBox[{
         RowBox[{"3", "/", "10"}], ",", "R"}], "]"}]}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.8903820305905695`*^9, 3.8903826931344204`*^9, {3.890382770749684*^9, 
   3.8903827848788958`*^9}, {3.8903852942666187`*^9, 
   3.8903853005056825`*^9}, {3.8975513984135113`*^9, 3.8975513990708246`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"ac84bf8d-9855-46ea-95ef-4e15d6d6a9f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "COMPUTE", " ", "STRAIN", " ", "ENERGY", " ", "DENSITY", " ", "FUNCTION"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SEdens", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Flatten", "[", "sigma", "]"}], ".", 
       RowBox[{"Flatten", "[", "epsilon", "]"}]}], ")"}]}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8903820414166746`*^9, 3.890382052954074*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"22f65afc-2184-4b45-852c-768ef92730f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"COMPUTE", " ", "STRAIN", " ", "ENERGY"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "strain", " ", "energy", " ", "is", " ", "computed", " ", 
     "in", " ", "two", " ", "steps"}], ",", " ", 
    RowBox[{
    "as", " ", "described", " ", "in", " ", "MoMS_Hole", "_", "2", 
     "D_Natural", 
     RowBox[{"_log", ".", "nb"}], " ", "for", " ", "the"}]}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"2", "D", " ", 
     RowBox[{"case", ".", " ", "Note"}]}], ",", " ", "however", ",", " ", 
    RowBox[{
    "that", " ", "the", " ", "equations", " ", "below", " ", "cannot", " ", 
     "be", " ", "computed", " ", "symbolically", " ", "for", " ", "the", " ", 
     "current"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"natural", "-", "log", "-", 
     RowBox[{"based", " ", "displacement", " ", "field", " ", "in", " ", "3", 
      RowBox[{"D", "."}]}]}], " ", "\[Rule]", " ", 
    RowBox[{
    "Mathematica", " ", "will", " ", "throw", " ", "back", " ", "the", " ", 
     "integral", " ", "without"}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"solving", " ", 
    RowBox[{"it", "."}]}], 
   "                                                                          \
            ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SEcube", "=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"SE", "/.", 
        RowBox[{"{", 
         RowBox[{"r", "\[Rule]", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x", "^", "2"}], "+", 
            RowBox[{"y", "^", "2"}], "+", 
            RowBox[{"z", "^", "2"}]}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "L"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SEhole", " ", "=", " ", 
     RowBox[{"Integrate", "[", 
      RowBox[{"SE", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0", ",", "R"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phi1", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phi2", ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SE", " ", "=", " ", 
     RowBox[{"SEcube", "-", "SEhole"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SE", "//", "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.890382082062062*^9, 3.890382109795389*^9}, {
  3.8903829457057333`*^9, 3.8903829688773313`*^9}, {3.8903832336181707`*^9, 
  3.890383342947875*^9}, {3.890476645452569*^9, 3.890476685329108*^9}, {
  3.8910816434802327`*^9, 3.891081803156789*^9}, {3.8975514308062124`*^9, 
  3.897551438799079*^9}},ExpressionUUID->"5cd5b118-336d-41e8-abfd-\
32b164c3144a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "REMARK", " ", "TO", " ", "THE", " ", "ISSUE", " ", "WITH", " ", "THE", 
    " ", "STRAIN", " ", "ENERGY", " ", "COMPUTATION"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "While", " ", "simpler", " ", "forms", " ", "of", " ", "the", " ", 
      "Log"}], "-", 
     RowBox[{
     "function", " ", "integral", " ", "can", " ", "be", " ", "analytically", 
      " ", "computed"}]}], ",", " ", 
    RowBox[{"such", " ", "as"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", " ", "and"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"x", "+", "y", "+", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", "y", "+", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "If", " ", "there", " ", "are", " ", "more", " ", "than", " ", "one", " ",
      "square", " ", "terms"}], ",", " ", 
    RowBox[{"the", " ", "computation", " ", "fails"}], ",", " ", 
    RowBox[{"e", ".", "g", "."}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Below", " ", "you", " ", "find", " ", "the", " ", "type", " ", "of", " ", 
    "integrand", " ", "that", " ", "needs", " ", "to", " ", "be", " ", 
    "integrated", " ", "when", " ", "computing", " ", "the"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "strain", " ", "energy"}], ",", " ", 
    RowBox[{"which", " ", "also", " ", "cannot", " ", "be", " ", "solved"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.89038373173225*^9, 3.8903837397330236`*^9}, 
   3.890383784808427*^9, {3.890384039754797*^9, 3.8903841076994143`*^9}, {
   3.890476694924493*^9, 3.890476726206931*^9}, {3.890476926851364*^9, 
   3.890477277752963*^9}, {3.8904774447577224`*^9, 3.8904774459636917`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"21e103aa-b57c-4879-b1b0-2564e0d31bed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"PLOT", " ", "FIELDS", " ", "ALONG", " ", "CUT", " ", "LINE"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EmodChosen", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nuChosen", "=", 
     RowBox[{"3", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cChosen", "=", 
     RowBox[{"cRule", "[", 
      RowBox[{"nuChosen", ",", "R"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "\[Rule]", "rr"}], ",", 
          RowBox[{"c", "\[Rule]", "cChosen"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "\[Rule]", "rr"}], ",", 
          RowBox[{"Emod", "\[Rule]", "EmodChosen"}], ",", 
          RowBox[{"nu", "\[Rule]", "nuChosen"}], ",", 
          RowBox[{"c", "\[Rule]", "cChosen"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"br", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "\[Rule]", "rr"}], ",", 
          RowBox[{"Emod", "\[Rule]", "EmodChosen"}], ",", 
          RowBox[{"nu", "\[Rule]", "nuChosen"}], ",", 
          RowBox[{"c", "\[Rule]", "cChosen"}]}], "}"}]}], ","}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"rr", ",", "0", ",", 
       RowBox[{"4", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "3"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(u\), \(r\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(rr\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(b\), \(r\)]\)\>\""}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.863132858746126*^9, 3.8631329185672846`*^9}, {
   3.8631329626796417`*^9, 3.8631329847719126`*^9}, {3.863133342559372*^9, 
   3.8631333722937655`*^9}, {3.864705516040763*^9, 3.864705524721882*^9}, {
   3.8647056094115577`*^9, 3.8647056256302295`*^9}, {3.8647057582254725`*^9, 
   3.86470575879195*^9}, {3.8647057986737185`*^9, 3.864705885968543*^9}, {
   3.8720730603267117`*^9, 3.8720731482712355`*^9}, {3.872073210032405*^9, 
   3.8720732281927505`*^9}, {3.8720733600662403`*^9, 
   3.8720734385005164`*^9}, {3.8720735564766407`*^9, 
   3.8720735621854286`*^9}, {3.8720736133960295`*^9, 
   3.8720736658715324`*^9}, {3.872144197539756*^9, 3.8721442016308246`*^9}, {
   3.8722189237225456`*^9, 3.872218943936866*^9}, {3.872219007469354*^9, 
   3.87221903991661*^9}, {3.8722195660496874`*^9, 3.8722196124983473`*^9}, {
   3.8722199334922695`*^9, 3.8722199956300716`*^9}, {3.8722200656236677`*^9, 
   3.872220109303305*^9}, {3.8722201469115267`*^9, 3.8722201482104692`*^9}, {
   3.872220222003872*^9, 3.872220243351054*^9}, {3.872834954683972*^9, 
   3.872834973485779*^9}, {3.8728350037659082`*^9, 3.872835036562828*^9}, {
   3.872835732003107*^9, 3.87283573629554*^9}, {3.8728358885644565`*^9, 
   3.8728358902469354`*^9}, {3.8728359315349035`*^9, 3.872835954905466*^9}, {
   3.8729198577606773`*^9, 3.872919899867221*^9}, {3.872919940199662*^9, 
   3.872919942341652*^9}, {3.872920005906057*^9, 3.8729200834388266`*^9}, {
   3.8729272848095336`*^9, 3.8729272936955075`*^9}, {3.873190031840736*^9, 
   3.873190051171297*^9}, {3.8731901129875727`*^9, 3.87319022545487*^9}, {
   3.87319029727777*^9, 3.873190402767202*^9}, {3.873190536346759*^9, 
   3.8731905500349803`*^9}, {3.874914811072904*^9, 3.874914848832987*^9}, 
   3.8749148854331293`*^9, {3.874914936115218*^9, 3.8749150849600515`*^9}, {
   3.890381984513199*^9, 3.8903820276197977`*^9}, {3.8903829957472277`*^9, 
   3.8903831531541862`*^9}, {3.8903831913439455`*^9, 3.890383212469122*^9}, {
   3.890476552919097*^9, 3.8904766221828446`*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"c53a66ac-f91a-4703-8b56-dc4624383c89"]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2577, 38, 347, "Text",ExpressionUUID->"4ab4f0f1-5349-4daa-8543-53b592c4ec8f"],
Cell[3138, 60, 2768, 70, 117, "Input",ExpressionUUID->"a73fe76b-7303-41d6-a1a5-fcac2502d3ab"],
Cell[5909, 132, 2296, 55, 135, "Input",ExpressionUUID->"48e62b2f-1b7d-4402-8dd1-4c422df3117c"],
Cell[8208, 189, 7796, 125, 171, "Input",ExpressionUUID->"875a41bc-fbba-40c0-a967-96896b1a9c88"],
Cell[16007, 316, 1805, 34, 117, "Input",ExpressionUUID->"1ef77fd1-bfac-4a45-8153-16f6c48779e3"],
Cell[17815, 352, 948, 26, 63, "Input",ExpressionUUID->"a5b44dd6-0f99-4ee3-9a99-a189a9dda3f4"],
Cell[18766, 380, 2038, 55, 99, "Input",ExpressionUUID->"ac84bf8d-9855-46ea-95ef-4e15d6d6a9f8"],
Cell[20807, 437, 600, 17, 45, "Input",ExpressionUUID->"22f65afc-2184-4b45-852c-768ef92730f5"],
Cell[21410, 456, 3099, 78, 171, "Input",ExpressionUUID->"5cd5b118-336d-41e8-abfd-32b164c3144a"],
Cell[24512, 536, 3938, 105, 189, "Input",ExpressionUUID->"21e103aa-b57c-4879-b1b0-2564e0d31bed"],
Cell[28453, 643, 4303, 90, 171, "Input",ExpressionUUID->"c53a66ac-f91a-4703-8b56-dc4624383c89"]
}
]
*)

